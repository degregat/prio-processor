# Command Line Reference

## prio help

```bash
Usage: prio [OPTIONS] COMMAND [ARGS]...

Options:
  --help  Show this message and exit.

Commands:
  aggregate      Generate an aggregate share from a batch of verified SNIPs
  encode-shares
  keygen         Generate a curve25519 key pair as json.
  publish        Generate a final aggregate and remap data to a content...
  shared-seed    Generate a shared server secret in base64.
  verify1        Decode a batch of shares
  verify2        Verify a batch of SNIPs
```

### `prio aggregate`

```bash
Usage: prio aggregate [OPTIONS]

  Generate an aggregate share from a batch of verified SNIPs

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --input-external TEXT           File containing data generated by the co-
                                  processing server.  [required]

  --input-internal TEXT           File containing data generated by the
                                  processing server.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

### `prio encode-shares`

```bash
Usage: prio encode-shares [OPTIONS]

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --output-B DIRECTORY            The path to the input directory of server B.
                                  [required]

  --output-A DIRECTORY            The path to the input directory of server A.
                                  [required]

  --help                          Show this message and exit.
```

### `prio keygen`

```bash
Usage: prio keygen [OPTIONS]

  Generate a curve25519 key pair as json.

Options:
  --help  Show this message and exit.
```

### `prio publish`

```bash
Usage: prio publish [OPTIONS]

  Generate a final aggregate and remap data to a content blocklist

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input-external TEXT           File containing data generated by the co-
                                  processing server.  [required]

  --input-internal TEXT           File containing data generated by the
                                  processing server.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

### `prio shared-seed`

```bash
Usage: prio shared-seed [OPTIONS]

  Generate a shared server secret in base64.

Options:
  --help  Show this message and exit.
```

### `prio verify1`

```bash
Usage: prio verify1 [OPTIONS]

  Decode a batch of shares

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

### `prio verify2`

```bash
Usage: prio verify2 [OPTIONS]

  Verify a batch of SNIPs

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --input-external TEXT           File containing data generated by the co-
                                  processing server.  [required]

  --input-internal TEXT           File containing data generated by the
                                  processing server.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

## prio-spark help

```bash
Usage: prio-spark [OPTIONS] COMMAND [ARGS]...

Options:
  --help  Show this message and exit.

Commands:
  aggregate             Generate an aggregate share from a batch of
                        verified...

  encode-shares
  generate
  generate-integration  Generate test data from a configuration file.
  publish               Generate a final aggregate.
  verify1               Decode a batch of shares
  verify2               Verify a batch of SNIPs
```

### `prio-spark aggregate`

```bash
Usage: prio-spark aggregate [OPTIONS]

  Generate an aggregate share from a batch of verified SNIPs

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --input-external TEXT           File containing data generated by the co-
                                  processing server.  [required]

  --input-internal TEXT           File containing data generated by the
                                  processing server.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

### `prio-spark encode-shares`

```bash
Usage: prio-spark encode-shares [OPTIONS]

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --output-B DIRECTORY            The path to the input directory of server B.
                                  [required]

  --output-A DIRECTORY            The path to the input directory of server A.
                                  [required]

  --help                          Show this message and exit.
```

### `prio-spark generate`

```bash
Usage: prio-spark generate [OPTIONS]

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --n-rows INTEGER                Number of rows randomly generate.
  --scale INTEGER                 Factor to duplicate shares for output.
  --partition-size-mb INTEGER
  --help                          Show this message and exit.
```

### `prio-spark generate-integration`

```bash
Usage: prio-spark generate-integration [OPTIONS]

  Generate test data from a configuration file.

  The data is generated in a deterministic way and fits into memory.

Options:
  --data-config FILE
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --n-rows INTEGER                Number of rows to generate per batch.
  --n-partitions INTEGER          Number of partitions for each batch.
  --n-drop-batch INTEGER          Number of batch_ids to drop.
  --help                          Show this message and exit.
```

### `prio-spark publish`

```bash
Usage: prio-spark publish [OPTIONS]

  Generate a final aggregate.

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input-external TEXT           File containing data generated by the co-
                                  processing server.  [required]

  --input-internal TEXT           File containing data generated by the
                                  processing server.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

### `prio-spark verify1`

```bash
Usage: prio-spark verify1 [OPTIONS]

  Decode a batch of shares

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

### `prio-spark verify2`

```bash
Usage: prio-spark verify2 [OPTIONS]

  Verify a batch of SNIPs

Options:
  --n-data INTEGER                The size of the input bit-vector.
                                  [required]

  --batch-id BYTE-STRING          A shared batch identifier used as a validity
                                  check.  [required]

  --shared-secret BYTE-STRING     The shared server secret encoded in base64.
                                  [required]

  --private-key-hex BYTE-STRING   The private key of the processing server as
                                  a hex string.  [required]

  --server-id [A|B]               The identifier for match.  [required]
  --public-key-hex-external BYTE-STRING
                                  The public key of the co-processing server
                                  as a hex string.  [required]

  --public-key-hex-internal BYTE-STRING
                                  The public key of the processing server as a
                                  hex string.  [required]

  --input TEXT                    File containing shares from clients.
                                  [required]

  --input-external TEXT           File containing data generated by the co-
                                  processing server.  [required]

  --input-internal TEXT           File containing data generated by the
                                  processing server.  [required]

  --output DIRECTORY              The path to the output directory.
                                  [required]

  --help                          Show this message and exit.
```

## prio-processor help

```bash
Usage: prio-processor [OPTIONS] COMMAND [ARGS]...

Options:
  --help  Show this message and exit.

Commands:
  fetch-origins  Fetch data about origins being collected by Firefox...
  index          Take the resulting Prio aggregates and map the indices to...
  staging
```

### `prio-processor fetch-origins`

```bash
Usage: prio-processor fetch-origins [OPTIONS]

  Fetch data about origins being collected by Firefox telemetry via Prio.

Options:
  --url TEXT
  --output FILENAME
  --help             Show this message and exit.
```

### `prio-processor index`

```bash
Usage: prio-processor index [OPTIONS]

  Take the resulting Prio aggregates and map the indices to their original
  origins.

Options:
  --input TEXT    location of the prio aggregated-data  [required]
  --output TEXT   location of the resulting indexed data  [required]
  --config TEXT   location of the whitelist of batch-ids and their sizes
                  [required]

  --origins TEXT  JSON document with origins data  [required]
  --help          Show this message and exit.
```

### `prio-processor staging`

```bash
Usage: prio-processor staging [OPTIONS]

Options:
  --date TEXT              The submission date for filtering in YYYY-MM-DD
                           format  [required]

  --input TEXT             The fully-qualified GCS path or BigQuery table name
                           [required]

  --output TEXT            Output path  [required]
  --source [gcs|bigquery]  The storage location for reading raw prio pings
  --credentials TEXT       Path to google application credentials
  --help                   Show this message and exit.
```
